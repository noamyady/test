<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shift Schedule</title>
    <style>
        table { width: 100%; border-collapse: collapse; }
        td, th { border: 1px solid black; width: 100px; height: 50px; text-align: center; vertical-align: middle; }
        th { background-color: #d3d3d3; }
        td.clickable { background-color: white; cursor: pointer; }
        td.green { background-color: green; color: white; }
        .submit-section { margin-top: 20px; }
        button { margin-top: 10px; padding: 10px 15px; }
    </style>
</head>
<body>
    <h2>משמרות</h2>
    <table id="shiftTable">
        <tr>
            <th>שבת</th>
            <th>שישי</th>
            <th>חמישי</th>
            <th>רביעי</th>
            <th>שלישי</th>
            <th>שני</th>
            <th>ראשון</th>
            <th>משמרות</th>
        </tr>
        <tr>
            <td class="clickable">שבת בוקר</td>
            <td class="clickable">שישי בוקר</td>
            <td class="clickable">חמישי בוקר</td>
            <td class="clickable">רביעי בוקר</td>
            <td class="clickable">שלישי בוקר</td>
            <td class="clickable">שני בוקר</td>
            <td class="clickable">ראשון בוקר</td>
            <td rowspan="1" style="background-color: #ffeb99;">כפר שמריהו יום 7-19</td>
        </tr>
        <!-- More rows as needed -->
    </table>

    <div class="submit-section">
        <form id="submitForm">
            <label for="name">הזן שם:</label>
            <input type="text" id="name" required />
            <button type="submit">שלח</button>
        </form>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '312907888554-grn3eeg85q5oc9vocpv3b2ok4flim6c9.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyBzjT06dQutjTe2PYv-rSIkZ9NTjFX1290';
        const SPREADSHEET_ID = '18P7Bg2z28XshDAe4w5xvMAXPF-1v4uAOhDa9VOod2vM';
        const RANGE = 'Sheet1!Z1';  // Change this to your desired range

        function authenticate() {
            return gapi.auth2.getAuthInstance()
                .signIn({scope: "https://www.googleapis.com/auth/spreadsheets"});
        }

        function loadClient() {
            gapi.client.setApiKey(API_KEY);
            return gapi.client.load("https://sheets.googleapis.com/$discovery/rest?version=v4")
                .then(function() { console.log("GAPI client loaded for API"); },
                      function(err) { console.error("Error loading GAPI client for API", err); });
        }

        document.getElementById('submitForm').addEventListener('submit', function(event) {
            event.preventDefault();
            authenticate().then(loadClient).then(() => {
                const name = document.getElementById('name').value;
                const clickedCells = [...document.querySelectorAll('.clickable.green')].map(cell => cell.textContent);
                const data = [[name, ...clickedCells]];
                
                return gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: RANGE,
                    valueInputOption: 'RAW',
                    resource: { values: data }
                }).then(response => {
                    console.log(`${response.result.updates.updatedCells} cells appended.`);
                    alert('Data sent to Google Sheets!');
                }, err => console.error("Execute error", err));
            });
        });

        gapi.load("client:auth2", function() {
            gapi.auth2.init({client_id: CLIENT_ID});
        });
    </script>
</body>
</html>
